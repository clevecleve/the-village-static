"use strict";(self.webpackChunkconsumer=self.webpackChunkconsumer||[]).push([[8318],{11501:(e,s,l)=>{l.d(s,{A:()=>n});var i=l(69499),t=l(61995);class a extends i.Component{constructor(){super(...arguments),this.setMargin=()=>("standard"===this.props.margin?this.margin="standard-margin":"small"===this.props.margin?this.margin="small-margin":"custom"===this.props.margin?this.margin="custom-margin":"campaign"===this.props.margin?this.margin="campaign-margin":this.margin="",this.margin)}render(){return(0,t.jsx)("div",{className:`base-component ${this.setMargin()} ${this.props.className}`,children:this.props.children})}}const n=a},24827:(e,s,l)=>{l.d(s,{A:()=>t});l(69499);var i=l(61995);const t=()=>(0,i.jsx)("div",{className:"loader-wrapper",children:(0,i.jsx)("div",{className:"loader"})})},66243:(e,s,l)=>{l.d(s,{A:()=>a});l(69499);var i=l(98558),t=l(61995);const a=e=>{const{iconValue:s=null,linkUrl:l=null,linkName:a=null,size:n=16,mapInfo:r=null,noLocation:o=!1,withViewOnMap:c=!1}=e;return s&&a&&a.value?(0,t.jsxs)("div",{className:"details-wrapper",children:[(0,t.jsx)("i",{className:`icon icon-${s} mr-1 mr-md-2`,style:{fontSize:n+"px"}}),l&&l.length&&o?(0,t.jsx)("a",{href:l,children:(0,t.jsx)(i.Text,{field:a})}):l&&l.length&&c?(0,t.jsxs)("div",{className:"separated-location",children:[(0,t.jsx)("span",{children:(0,t.jsx)(i.Text,{field:a})}),(0,t.jsx)("a",{href:l+"#/profile?location="+r,children:"View on map"})]}):l&&l.length?(0,t.jsx)("a",{href:l+"#/profile?location="+r,children:(0,t.jsx)(i.Text,{field:a})}):(0,t.jsx)(i.Text,{field:a})]}):null}},74482:(e,s,l)=>{l.r(s),l.d(s,{default:()=>p});var i=l(69499),t=l(98558),a=l(43210),n=l.n(a),r=l(11501),o=l(66243),c=l(24827),d=l(363),h=l.n(d),m=l(61995);class u extends i.Component{constructor(e){super(e),this.handleScroll=()=>{window&&window.outerWidth<992&&(this.state.showContentLoader||this.state.preview)?this.disableScroll():this.enableScroll()},this.handleClick=()=>{window&&window.outerWidth<992&&this.disableScroll()},this.enableScroll=()=>{document.querySelector("html").style.overflowY="auto"},this.disableScroll=()=>{document.querySelector("html").style.overflowY="hidden"},this.getRetailerList=async(e,s)=>{const{pageId:l,dbName:i}=this.state,t={pageId:l,dbName:i,pageNumber:e,pageSize:12};s&&this.setState({isScrolling:!0});try{let s=await n()({method:"GET",url:"/api/sitecore/ministoredirectory/minisearch",params:t});if(s&&s.data&&s.data.ResultList){const{TotalCount:l,Page:i,ResultList:t}=s.data,a=Math.ceil(l.value/12),n=e>1?this.state.retailers.concat(t):t,r=l&&l.value?l.value:0,o=i&&i.value?i.value:1;this.setState({...this.state,retailers:n,totalCount:r,currentPage:o,hasMoreItems:o!=a,isScrolling:!1,showLoader:!1})}else this.setState({showLoader:!1,noResults:!0})}catch(a){console.log(a),this.setState({showLoader:!1,noResults:!0})}},this.getRetailerContent=async e=>{const{pageId:s,dbName:l}=this.state,i={pageId:s,dbName:l,itemId:e&&e.value||null};this.setState({noSelection:!1,showContentLoader:!0});try{let e=await n()({method:"GET",url:"api/sitecore/ministoredirectory/getstorecontent",params:i});e&&e.data&&this.setState({preview:e.data,showContentLoader:!1})}catch(t){this.setState({showContentLoader:!1})}},this.renderRetailerList=(e,s)=>{const{NoResultsText:l}=this.props.fields;return e&&e.length?(0,m.jsxs)("div",{className:"col-12 col-lg-5",children:[e.map((e,s)=>{const{ItemId:l=null,OpeningTime:i=null,RetailerName:a=null,Logo:n=null}=e;return(0,m.jsxs)("div",{className:"retailers-list",onClick:()=>{this.handleClick(),this.getRetailerContent(l)},children:[n&&n.value&&n.value.src?(0,m.jsx)("div",{className:"logo with-logo",children:(0,m.jsx)("img",{...n.value,className:"lazyload"})}):(0,m.jsx)("div",{className:"logo",children:this.getRetailerLogo(a&&a.value)}),(0,m.jsxs)("div",{className:"info",children:[(0,m.jsx)("div",{className:"name",children:(0,m.jsx)(t.Text,{field:a})}),(0,m.jsx)("div",{className:"hours",children:(0,m.jsx)(t.Text,{field:i})})]}),(0,m.jsx)("i",{className:"icon icon-chevron-right"})]},`SDItem${s}`)}),s&&(0,m.jsx)(c.A,{})]}):(0,m.jsx)("div",{className:"col-12",children:(0,m.jsx)("div",{className:"no-results",children:(0,m.jsx)(t.Text,{field:l})})})},this.handleClickBrauzBtn=e=>{window.Brauz_open_book_a_stylist_dialog_with_selected_store(e)},this.renderRetailerPreview=()=>{const{preview:e,showContentLoader:s,noSelection:l,noResults:a}=this.state,{NoSelectionText:n}=this.props.fields;if(!l){if(s)return(0,m.jsxs)(i.Fragment,{children:[(0,m.jsx)("div",{className:"preview-blur"}),(0,m.jsx)("div",{className:"retailer-preview-container col-lg-6 offset-lg-1",children:(0,m.jsx)("div",{className:"retailer-preview-loader",children:(0,m.jsx)(c.A,{})})})]});if(e){const{RetailerName:s=null,Logo:l=null,OpeningTime:a=null,OpeningHours:n=null,StoreLocation:r=null,StoreLocationLink:c=null,ItemId:d=null,PhoneNumber:h=null,ExternalLink:u=null,FacebookLink:p=null,InstagramLink:x=null,BookingIcon:g=null,BookingLabel:v=null,BookingUrl:j=null,HasBooking:N=null}=e;return(0,m.jsxs)(i.Fragment,{children:[(0,m.jsx)("div",{className:"preview-blur"}),(0,m.jsx)("div",{className:"retailer-preview-container col-12 col-lg-6 offset-lg-1",children:(0,m.jsxs)("div",{className:"retailer-content",children:[(0,m.jsx)("div",{className:"close-wrapper",children:(0,m.jsx)("i",{className:"icon icon-close d-lg-none",onClick:()=>{this.enableScroll(),this.setState({preview:null,noSelection:!0})}})}),(0,m.jsxs)("div",{className:"header",children:[(0,m.jsx)("div",{className:"name order-2 order-lg-1",children:(0,m.jsx)(t.Text,{field:s})}),l&&l.value&&l.value.src?(0,m.jsx)("div",{className:"logo order-1 order-lg-2",children:(0,m.jsx)("img",{...l.value,className:"lazyload"})}):""]}),a&&a.value?(0,m.jsxs)("div",{className:"opening-hours-wrapper",children:[(0,m.jsx)("i",{className:"icon icon-time"}),(0,m.jsx)("div",{className:"opening-time",children:(0,m.jsx)(t.Text,{field:a})})]}):n&&n.length?(0,m.jsxs)("div",{className:"opening-hours-wrapper",children:[(0,m.jsx)("i",{className:"icon icon-time"}),(0,m.jsx)("div",{className:"opening-hours",children:n.map((e,s)=>{const{Day:l=null,Time:i=null,SecondaryTime:a=null}=e;return(0,m.jsxs)("div",{className:"opening-hour-item",children:[(0,m.jsx)("div",{className:"col-4 col-md-2 col-lg-3 day",children:(0,m.jsx)(t.Text,{field:l})}),(0,m.jsx)("div",{className:"col-6 col-md-3 col-lg-6 primary-time",children:(0,m.jsx)(t.Text,{field:i})}),a&&a.value&&(0,m.jsx)("div",{className:"col-6 col-md-3 col-lg-6 secondary-time",children:(0,m.jsx)(t.Text,{field:a})})]},`SDItemHour${s}`)})})]}):"",(0,m.jsx)(o.A,{iconValue:"location mr-2",linkUrl:c&&c.value,linkName:r,size:"24",withViewOnMap:!0,mapInfo:d&&d.value?d.value:""}),h&&h.value&&(0,m.jsx)(o.A,{size:"24",iconValue:"phone-call mr-2",noLocation:!0,linkName:h,linkUrl:`tel:${h.value}`}),u&&u.value&&(0,m.jsx)(o.A,{size:"24",iconValue:"globe mr-2",noLocation:!0,linkName:u,linkUrl:u.value}),p&&p.value&&(0,m.jsx)(o.A,{size:"24",iconValue:"facebook-2 mr-2",noLocation:!0,linkName:p,linkUrl:p.value}),x&&x.value&&(0,m.jsx)(o.A,{size:"24",iconValue:"instagram-2 mr-2",noLocation:!0,linkName:this.getUsername(x.value),linkUrl:x.value}),N&&N.value?(0,m.jsxs)("div",{className:"details-wrapper",children:[g&&g.value?(0,m.jsx)("i",{className:`icon icon-${g.value} mr-2`,style:{fontSize:"24px"}}):(0,m.jsx)("i",{className:"icon icon-calendar-2 mr-2",style:{fontSize:"24px"}}),(0,m.jsx)("button",{onClick:()=>this.handleClickBrauzBtn(d.value),children:(0,m.jsx)(t.Text,{field:v})})]}):j&&j.value?(0,m.jsxs)("div",{className:"details-wrapper",children:[g&&g.value?(0,m.jsx)("i",{className:`icon icon-${g.value} mr-2`,style:{fontSize:"24px"}}):(0,m.jsx)("i",{className:"icon icon-calendar-2 mr-2",style:{fontSize:"24px"}}),(0,m.jsx)("a",{href:j.value,target:"_blank",children:(0,m.jsx)(t.Text,{field:v})})]}):""]})})]})}return(0,m.jsx)("div",{className:"retailer-preview-container col-12 col-lg-6 offset-lg-1",children:(0,m.jsx)("div",{className:"retailer-content",children:(0,m.jsx)("div",{className:"no-info",children:"Something went wrong. Please try again."})})})}if(!a)return(0,m.jsx)("div",{className:"retailer-preview-container d-none d-lg-block col-lg-6 offset-lg-1",children:(0,m.jsx)("div",{className:"no-selection",children:(0,m.jsx)(t.Text,{field:n})})})},this.getUsername=e=>{const s=e.match(/(?:(?:http|https):\/\/)?(?:www.)?(?:instagram.com|instagr.am)\/([A-Za-z0-9-_]+)/);return s&&s[1]&&"explore"!==s[1]?{value:"@"+s[1]}:null},this.getRetailerLogo=e=>{const s=e.match(/\b(\w)/g).join("").slice(0,2);return(0,m.jsx)("div",{className:"initials",children:s.toUpperCase()})},this.state={pageId:null,dbName:null,retailers:null,preview:null,noSelection:!0,noResults:!1,showContentLoader:!1,currentPage:1,totalCount:0,showLoader:!0,isScrolling:!1,hasMoreItems:!0}}componentDidMount(){let e=window.document.getElementsByName("ContextItem")[0];const{BrauzFormId:s=null}=this.props.fields||{};if(this.setState({pageId:e.value,dbName:e.dataset.targetDb},()=>this.getRetailerList(1)),window&&window.addEventListener("resize",this.handleScroll),s&&s.value){const e="https://d3aq2u4yw77ivo.cloudfront.net/retailer-appointment/public/1.0/bookAStylist.prod.js";this.loadScript(e,()=>{window.Brauz.initializeBrauzBookAStylist(s.value)})}}loadScript(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};if(e){const l=document.createElement("script");l.setAttribute("type","text/javascript"),l.setAttribute("src",e),document.body.appendChild(l),l.onload=s}}loadRetailerList(){this.getRetailerList(this.state.currentPage+1,!0)}render(){const{showLoader:e,isScrolling:s,retailers:l}=this.state,{RemoveDefaultMargin:i=""}=this.props.params||{},{ApplySmallMargin:t=""}=this.props.params||{},a=i&&"1"===i?"":t&&"1"===t?"small":"standard";return(0,m.jsx)(r.A,{margin:a,children:(0,m.jsx)("div",{className:"mini-storedirectory-container",children:(0,m.jsxs)("div",{className:"container",children:[(0,m.jsx)(h(),{style:{height:"auto",overflow:"auto"},dataLength:l&&l.length,next:this.loadRetailerList.bind(this),hasMore:this.state.hasMoreItems,scrollThreshold:.5}),e&&(0,m.jsx)(c.A,{}),!e&&(0,m.jsxs)("div",{className:"mini-storedirectory-wrapper row",children:[this.renderRetailerList(l,s),this.renderRetailerPreview()]})]})})})}}const p=u}}]);
//# sourceMappingURL=MiniStoreDirectory.5cca3e1c.chunk.js.map